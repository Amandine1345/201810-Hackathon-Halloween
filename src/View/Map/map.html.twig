{% extends 'layout.html.twig' %}


{% block map %}

<link rel="icon" href="/assets/images/favicon.png">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
            crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
            crossorigin=""></script>
    <link rel="stylesheet" href="/assets/css/map.css">

{% endblock %}

{% block content %}

<script type="text/javascript">


			// On initialise la latitude et la longitude de Paris (centre de la carte)
			
      let latPos = 47.919014;
      let lonPos = 1.898694;
      let lat = 0;
      let lon = 0;
      let marker = "";
			let macarte = null;
			// Fonction d'initialisation de la carte
			function initMap() {
				// Créer l'objet "macarte" et l'insèrer dans l'élément HTML qui a l'ID "map"
            macarte = L.map('map').setView([latPos, lonPos], 11);
            // Leaflet ne récupère pas les cartes (tiles) sur un serveur par défaut. Nous devons lui préciser où nous souhaitons les récupérer. Ici, openstreetmap.fr
            L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
                // Il est toujours bien de laisser le lien vers la source des données
                attribution: 'données © <a href="//osm.org/copyright">OpenStreetMap</a>/ODbL - rendu <a href="//openstreetmap.fr">OSM France</a>',
                minZoom: 14,
                maxZoom: 20
            }).addTo(macarte);
              {% for data in datas %}
                lat = {{ data.latitude }};
                lon = {{ data.longitude }};
                marker = L.marker([lat, lon]).addTo(macarte);
                marker.bindPopup( 
                " {{ data.joueur_nom }}" +
                "<img src='{{ data.bonbon_image }}' width:'80px' height='80px' /></br />" + 
                "{{ data.bonbon_nom }} <br />" + 
                "<form method='post' action='/'>" +
                  "<button name=''>Je l ai !</button>" + 
                "</form>"
                );
              {% endfor %}
            }
			window.onload = function(){
				// Fonction d'initialisation qui s'exécute lorsque le DOM est chargé
				initMap(); 
			};
		</script>

<section>
    <h1 >BONBONDEX</h1>
    <p class="mt-3">Bienvenue {{ session }}</p>
<div id="map"></div>
<span class="candy align-bottom">
            <a href="/option"><img src="assets/images/ico_candy.png" alt="candy" height="50vh" width="auto"></a>
        </span>
    </section>
{% endblock %}